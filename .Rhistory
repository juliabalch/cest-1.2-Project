knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(patchwork)
library(ggbeeswarm)
library(kableExtra)
library(magrittr)
theme_set(theme_classic())
AntTouch <- read_csv('cest1.2_anterior_touch_merged.csv') %>%
mutate(plate = as.factor(plate))
(bodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, is.na(additive), genotype != "daf-22",
food == "OP50") %>%
ggplot(aes(x = date, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior touch response",
y = "number of body bends per reversal") +
stat_summary(aes(shape = genotype), fun = mean, geom = "point",
color = "red", size = 2))
#Are num bends dependent on time on plate?
#(bends_by_order <- AntTouch %>%
# group_by(genotype, time_off_food, observer) %>%
#  mutate(index = row_number()) %>%
# ggplot(aes(x = index, y = bends)) +
#    geom_point()) +
#  facet_grid(time_off_food ~ genotype, scales = "free_y") +
#  geom_smooth(method = "lm")
