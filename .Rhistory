knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(patchwork)
library(ggbeeswarm)
library(kableExtra)
library(magrittr)
theme_set(theme_classic())
AntTouch <- read_csv('cest1.2_anterior_touch_merged.csv') %>%
mutate(plate = as.factor(plate))
(bodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, is.na(additive), genotype != "daf-22",
food == "OP50") %>%
ggplot(aes(x = date, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior touch response",
y = "number of body bends per reversal") +
stat_summary(aes(shape = genotype), fun = mean, geom = "point",
color = "red", size = 2))
#Are num bends dependent on time on plate?
#(bends_by_order <- AntTouch %>%
# group_by(genotype, time_off_food, observer) %>%
#  mutate(index = row_number()) %>%
# ggplot(aes(x = index, y = bends)) +
#    geom_point()) +
#  facet_grid(time_off_food ~ genotype, scales = "free_y") +
#  geom_smooth(method = "lm")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(patchwork)
library(ggbeeswarm)
library(kableExtra)
library(magrittr)
theme_set(theme_classic())
AntTouch <- read_csv('cest1.2_anterior_touch_merged.csv') %>%
mutate(plate = as.factor(plate))
dates_contaminated <- c("7/7/2021","7/8/2021","7/14/2021","7/15/2021")
(TAbodybendPlot <- AntTouch %>%
#filter(NumBends < 10) %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), !date %in% dates_contaminated) %>%
ggplot(aes(x = additive, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "Plate additive")+
facet_grid(.~ date))
(TAbodybendPlotCombined <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = additive, y = bends)) +
stat_summary(aes(fill= additive),
geom = "bar",
fun = "mean",
width = 0.5,
position = position_dodge(width = .65)) +
stat_summary(geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = .65)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(
y = "number of body bends per reversal"))
(TAtailtouchPlot <-
AntTouch %>%
ungroup() %>%
mutate(additive = case_when(
is.na(additive) ~ 'none',
TRUE ~ additive)) %>%
filter(is.na(note),  food == "OP50", additive != "H2O", !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = tail_touch)) +
# if you don't choose position = "fill", it will give you counts, not proportion
geom_bar(position = "fill") +
labs(title = "Tail touch probability in cest-1.2",
y = "proportion of tail touch events") +
facet_grid(.~additive) +
scale_fill_brewer(palette = "Pastel2", direction = -1))
(TAculturebodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
culture_conditons != "none") %>%
ggplot(aes(x = culture_conditons, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "culture plate additive"))
(TAbodybendPlot | TAtailtouchPlot)
dates_contaminated <- c("7/7/2021","7/8/2021","7/14/2021","7/15/2021")
(TAbodybendPlot <- AntTouch %>%
#filter(NumBends < 10) %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), date == "6/28/2022") %>%
ggplot(aes(x = additive, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "Plate additive")+
facet_grid(.~ date))
(TAbodybendPlotCombined <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = additive, y = bends)) +
stat_summary(aes(fill= additive),
geom = "bar",
fun = "mean",
width = 0.5,
position = position_dodge(width = .65)) +
stat_summary(geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = .65)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(
y = "number of body bends per reversal"))
(TAtailtouchPlot <-
AntTouch %>%
ungroup() %>%
mutate(additive = case_when(
is.na(additive) ~ 'none',
TRUE ~ additive)) %>%
filter(is.na(note),  food == "OP50", additive != "H2O", !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = tail_touch)) +
# if you don't choose position = "fill", it will give you counts, not proportion
geom_bar(position = "fill") +
labs(title = "Tail touch probability in cest-1.2",
y = "proportion of tail touch events") +
facet_grid(.~additive) +
scale_fill_brewer(palette = "Pastel2", direction = -1))
(TAculturebodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
culture_conditons != "none") %>%
ggplot(aes(x = culture_conditons, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "culture plate additive"))
(TAbodybendPlot | TAtailtouchPlot)
dates_contaminated <- c("7/7/2021","7/8/2021","7/14/2021","7/15/2021")
(TAbodybendPlot <- AntTouch %>%
#filter(NumBends < 10) %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), date == "6/28/2022") %>%
ggplot(aes(x = additive, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "Plate additive")+
facet_grid(.~ date))
(TAbodybendPlotCombined <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = additive, y = bends)) +
stat_summary(aes(fill= additive),
geom = "bar",
fun = "mean",
width = 0.5,
position = position_dodge(width = .65)) +
stat_summary(geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = .65)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(
y = "number of body bends per reversal"))
(TAtailtouchPlot <-
AntTouch %>%
ungroup() %>%
mutate(additive = case_when(
is.na(additive) ~ 'none',
TRUE ~ additive)) %>%
filter(is.na(note),  food == "OP50", additive != "H2O", !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = tail_touch)) +
# if you don't choose position = "fill", it will give you counts, not proportion
geom_bar(position = "fill") +
labs(title = "Tail touch probability in cest-1.2",
y = "proportion of tail touch events") +
facet_grid(.~additive) +
scale_fill_brewer(palette = "Pastel2", direction = -1))
(TAculturebodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
culture_conditons != "none") %>%
ggplot(aes(x = culture_conditons, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "culture plate additive"))
(TAbodybendPlot | TAtailtouchPlot)
dates_contaminated <- c("7/7/2021","7/8/2021","7/14/2021","7/15/2021")
(TAbodybendPlot <- AntTouch %>%
filter(date == c("6/28/2022")) %>%
ggplot(aes(x = genotype,fill=genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "genotype")+
facet_grid(date ~ additive))
(TAbodybendPlotCombined <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
!is.na(additive), !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = additive, y = bends)) +
stat_summary(aes(fill= additive),
geom = "bar",
fun = "mean",
width = 0.5,
position = position_dodge(width = .65)) +
stat_summary(geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = .65)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(
y = "number of body bends per reversal"))
(TAtailtouchPlot <-
AntTouch %>%
ungroup() %>%
mutate(additive = case_when(
is.na(additive) ~ 'none',
TRUE ~ additive)) %>%
filter(is.na(note),  food == "OP50", additive != "H2O", !date %in% dates_contaminated) %>%
ggplot(aes(x = genotype, fill = tail_touch)) +
# if you don't choose position = "fill", it will give you counts, not proportion
geom_bar(position = "fill") +
labs(title = "Tail touch probability in cest-1.2",
y = "proportion of tail touch events") +
facet_grid(.~additive) +
scale_fill_brewer(palette = "Pastel2", direction = -1))
(TAculturebodybendPlot <- AntTouch %>%
filter(is.na(note), time_off_food != 30, food == "OP50", genotype != "daf-22",
culture_conditons != "none") %>%
ggplot(aes(x = culture_conditons, fill = genotype, y = bends)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(group = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(color = genotype),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Accent") +
scale_fill_brewer(palette = "Accent") +
labs(title = "Body bends in anterior
touch response",
y = "number of body bends per reversal", x = "culture plate additive"))
(TAbodybendPlot | TAtailtouchPlot)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(patchwork)
library(ggbeeswarm)
library(kableExtra)
library(magrittr)
theme_set(theme_classic())
AntTouch <- read_csv('Video_Anterior_Touch.csv') %>%
mutate(plate = as.factor(plate))
View(AntTouch)
(distancePlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = length_mm)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "length of escape response reversal",
y = "number of body bends per reversal", x = "genotype")+
facet_grid(. ~ plate))
(speedPlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = `speed_mm/sec`)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "speed of escape response reversal",
y = "number of body bends per reversal", x = "genotype")+
facet_grid(. ~ plate))
(speedPlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = `speed_mm/sec`)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "speed of escape response reversal",
y = "number of body bends per reversal", x = "genotype")+
facet_grid(. ~ plate))
(distancePlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = length_mm)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "length of escape response reversal",
y = "distance (mm)", x = "genotype")+
facet_grid(. ~ plate))
(speedPlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = `speed_mm/sec`)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "speed of escape response reversal",
y = "speed (mm/sec)", x = "genotype")+
facet_grid(. ~ plate))
(distancePlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = length_mm)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "length of escape response reversal (distance)",
y = "distance (mm)", x = "genotype")+
facet_grid(. ~ plate))
(speedPlot <- AntTouch %>%
ggplot(aes(x = genotype,fill=genotype, y = time_sec)) +
geom_boxplot() +
ggbeeswarm::geom_quasirandom(aes(fill = genotype),
width = .1,
alpha = 0.3,
dodge.width = .75) +
stat_summary(aes(fill= genotype),
geom = "point",
fun = "mean",
width = 0.3,
position = position_dodge(width = .4)) +
stat_summary(aes(),
geom = "errorbar",
fun.data = "mean_se",
width = 0.1,
position = position_dodge(width = 1.6)) +
scale_color_brewer(palette = "Set1") +
scale_fill_brewer(palette = "Set1") +
labs(title = "length of escape response reversal (time)",
y = "time (sec)", x = "genotype")+
facet_grid(. ~ plate))
